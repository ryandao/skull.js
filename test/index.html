<head>

  <title>Ramaze</title>
  <link href="//fonts.googleapis.com/css?family=Open+Sans:400,300" rel="stylesheet" type="text/css">
  <link href="//fonts.googleapis.com/css?family=Allura" rel="stylesheet" type="text/css">
  <link href="//fonts.googleapis.com/css?family=Cinzel+Decorative:900" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="css/bootstrap.min.css">
  <link rel="stylesheet" href="css/main.css">
  <script type="text/javascript" src="js/jquery.js"></script>
  <script type="text/javascript" src="js/jquery.form.min.js"></script> 
  <script type="text/javascript" src="js/handlebars.js"></script>
  <script type="text/javascript" src="js/skull.js"></script>
  <script type="text/javascript" src="js/bootstrap.min.js"></script>
  <script type="text/javascript" src="js/main.js"></script>
  <script type="text/javascript" src="js/oauth.js"></script> 

  <script type="text/javascript">
    $(document).ready(function() { 
            // bind 'myForm' and provide a simple callback function 
            $('#myForm').ajaxForm(function() { 
                alert("Thank you for your comment!"); 
            }); 
    }); 
    function convertTimeStamp(mysql_date) {
      var t = mysql_date.split(/[- T : Z]/);
      var d = new Date(t[0], t[1] - 1, t[2], t[3], t[4], t[5]);
      var m_names = new Array("January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December");
      var curr_date = d.getDate();
      var curr_month = d.getMonth();
      var curr_year = d.getFullYear();

      return curr_date + " " + m_names[curr_month] + " " + curr_year;
    }
    function navigateToMovie(movieIndex){
      console.log(movieIndex)
      var url = "movies/" + movieIndex;
      App.router.navigate(url);
    }
  </script>
</head>

<body>
  <div class="navbar">
    <div style="position:fixed; box-shadow: 0 5px 15px rgba(0,0,0,0.5) !important;" class="navbar-inner navbar-fixed-top">
      <div class="container">
        <a class="brand" href="/#movies">Ramaze Movies: Based on Skull.js</a>
      </div>
    </div>
  </div>

  <div id="wrapper" class="container fluid"></div>

  <!--Template for movies_index-->
  <script type="text/x-handlebars-template" id="movies">
    <div class="page-header row-fluid">
      <h1 class="span10">Showing...</h1>
      <a href="#movies/new">
        <br/>
        <br/>
        <button class="btn btn-primary"> New movies </button>
      </a>
    </div>

    <div id="movie-list">
      <div class="row">
        {{#each "controller.movies"}}
            <div class="span4">
              <div class="cell">
                <img onclick='navigateToMovie({{item.id}})' class="clickable" id="viewMovie" src="{{item.img_url}}">
                <h4 style="text-align:center">{{bind "item.title"}}</h4>
                <p></p>
                <p style="text-align:center">{{item.updated_at}}</p>
                <br/>
                <br/>
              </div>
            </div>
        {{/each}}
      </div>
      <a {{action "previousPage"}} style="color:white" href="#">Previous Page&nbsp&nbsp</a>
      <a {{action "nextPage"}} style="color:white" href="#">&nbsp&nbspNext Page</a>
      <br/>
      <br/>
    </div>
  </script>
  <!--End movies_index template-->

  <!--Template for movies_view-->
  <script type="text/x-handlebars-template" id="movie_view">
    <div class="row-fluid" id="movie-display">
      <div class="span4">
          <img src={{controller.movie.content.img_url}}>
      </div>

      <div class="span7">
        <h3>{{controller.movie.content.title}}</h3>

        <p> Created by: {{controller.movie.content.user.username}} </p>

        <button {{action "deleteMovie"}} id="delete-movie-btn" class="btn btn-danger">
          Delete
        </button>
      </div>
    </div>

    <div id="review-list">
      <h3> Reviews </h3>
      {{#each "controller.reviews"}}
        <div class="well">
          <div class="row-fluid">
            <div class="span12">
              <strong> <font color="red"> {{item.user.username}} </font> </strong> 
              <font color="green">reviewed on {{item.updated_at}}</font>
              <span class="label label-success pull-right"> {{item.score}} points</span>
            </div>
          </div>

          <div class="row-fluid">
            <div class="span12">
              <p> <font color="blue">{{item.comment}} </font></p>
              <button {{action "deleteReview" item.id}} data-review-id="1" class="btn btn-danger remove-review-btn">Remove</button>
            </div>
          </div>
        </div>
      {{/each}}

      <div class="hero-unit">
        <form id="new-review-form">
          <textarea class="field span10" id="comment" name="review[comment]" rows="4" placeholder="Leave a review..."/>
          </textarea>
          <input type="number" id="score" name="review[score]" placeholder="Give a score from 0 to 100">
          <p> <button {{action "addReview"}} type="submit" id="add-review-btn" class="btn btn-primary btn-large">
            Add review
          </button> </p>
        </form>
      </div>
      
    </div>

  </script>
  <!--End movies_view template-->

</body>
